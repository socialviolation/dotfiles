#!/bin/sh

system_type=$(uname -s)

echo "YADM BOOTSTRAP: $sytem_type"
echo "home: $HOME"
ls -als $HOME


if [ "$system_type" = "Darwin" ]; then

  # install homebrew if it's missing
  if ! command -v brew >/dev/null 2>&1; then
    echo "Installing homebrew"
    /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
  fi

  if [ -f "$HOME/.Brewfile" ]; then
    echo "Updating homebrew bundle"
    brew bundle --global --file $HOME/.Brewfile

    echo "setup fzf"
    $(brew --prefix)/opt/fzf/install
  fi

  asdf plugin add asdf-plugin-manager https://github.com/asdf-community/asdf-plugin-manager.git
  asdf install asdf-plugin-manager 1.1.1

  asdf-plugin-manager add-all

  pip3 install neovim
  npm install -g neovim

fi

if [ ! -d "~/.tmux/plugins/tpm" ]; then
  printf 'Install TPM (tmux)? (y/n)? '
  read answer
  if [ "$answer" != "${answer#[Yy]}" ] ; then
    git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
  fi
fi


printf 'Install Meslo Nerd Font patched? (y/n)? '
read answer
if [ "$answer" != "${answer#[Yy]}" ] ; then
  # https://github.com/romkatv/powerlevel10k#meslo-nerd-font-patched-for-powerlevel10k
  wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf -P  /Library/Fonts/
  wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf -P  /Library/Fonts/
  wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf -P  /Library/Fonts/
  wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf -P  /Library/Fonts/
fi

power_dir="${HOME}/.powerlevel10k"
if [ ! -d "$power_dir" ]; then
  printf 'Install powerlevel10k (y/n)? '
  read answer

  if [ "$answer" != "${answer#[Yy]}" ] ;then 
    git clone --depth=1 https://github.com/romkatv/powerlevel10k.git $power_dir
  fi
fi


#NOTEPAD_DIR="$HOME/dev/notepad"
#[ ! -d "$NOTEPAD_DIR" ] && git clone git@github.com:socialviolation/notepad.git ${NOTEPAD_DIR}


# INSTRUCTIONS FOR LATER:
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm